import java.nio.charset.StandardCharsets
import org.apache.tools.ant.filters.ReplaceTokens

plugins {
    id 'io.papermc.paperweight.userdev' version '1.3.3'
    id 'maven-publish'
    id 'java'
}

group 'me.cooljwb'

def spigotVersion = '1.17.1-R0.1-SNAPSHOT'

def majorVersion = '2'
def minorVersion = '0'
def patchVersion = '1'

def projVersion = String.format('%s.%s.%s', majorVersion, minorVersion, patchVersion)

version projVersion

repositories {
    mavenCentral() // for transitive dependencies
}

dependencies {
    paperweightDevelopmentBundle('io.papermc.paper:dev-bundle:' + spigotVersion)
}

tasks {
    build {
        dependsOn(reobfJar)
        dependsOn(publishToMavenLocal)
    }

    compileJava {
        options.encoding = StandardCharsets.UTF_8.name()
        options.release.set(16)
    }
    javadoc {
        options.encoding = StandardCharsets.UTF_8.name()
    }
    processResources {
        filteringCharset = StandardCharsets.UTF_8.name()
    }
}

publishing {
    publications {
        maven(MavenPublication) {
            groupId = group
            artifactId = 'vulnerabilitypatcher'
            version = projVersion

            from components.java
        }
    }
}
